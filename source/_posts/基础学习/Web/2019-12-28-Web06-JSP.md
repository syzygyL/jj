---
title: Web06-JSP
tags:
  - note
comments: false
categories:
  - 基础学习
  - Web
date: 2019-12-27 08:00:22
description:
top:
---

# JSP 
## 简介

Java Server Pages ：java服务器端页面 ，其本质就是 servlet
* 可以理解为：一个特殊的页面，其中既可以指定定义html标签，又可以定义java代码
* 用于简化书写！！！

JSP  定义 Java 代码的方式
* <%  代码 %>：定义的java代码，生成在 service 方法中，service 方法中可以定义什么，该脚本中就可以定义什么
* <%! 代码 %>：定义的java代码，生成在  JSP  转换后的 java 类的成员位置
* <%= 代码 %>：定义的java代码，会输出到页面上，相当于 sout 语句

## JSP 指令

* 作用：用于配置JSP页面，导入资源文件
* 格式：
<%@ 指令名称 属性名1=属性值1 属性名2=属性值2 ... %>
* 分类：
1. page:配置 JSP 页面

* contentType:`response.setContentType()`
	1. 设置响应体的mime类型以及字符集
	2. 设置当前JSP页面的编码（只能是高级的IDE才能生效，如果使用低级工具，则需要设置pageEncoding属性设置当前页面的字符集）

* import：导包
* errorPage：当前页面发生异常后，会自动跳转到指定的错误页面
* isErrorPage：标识当前也是是否是错误页面。
	* true：是，可以使用内置对象exception
	* false：否。默认值。不可以使用内置对象exception

2. include	： 页面包含的。导入页面的资源文件
* <%@include file="top. JSP "%>
3. taglib	： 导入资源
* <%@ taglib prefix="c" uri="http://java.sun.com/ JSP /jstl/core" %>
	* prefix：前缀，自定义的
2. 注释:
1. html注释：
	<!-- -->:只能注释html代码片段
2. JSP注释：推荐使用
	<%-- --%>：可以注释所有


3. 内置对象

在JSP页面中不需要创建，直接使用的对象，一共有9个：
```java
	变量名					真实类型						作用
* pageContext				PageContext					当前页面共享数据，还可以获取其他八个内置对象
* request					HttpServletRequest			一次请求访问的多个资源(转发)
* session					HttpSession					一次会话的多个请求间
* application				ServletContext				所有用户间共享数据
* response					HttpServletResponse			响应对象
* page						Object						当前页面(Servlet)的对象  this
* out						JspWriter					输出对象，数据输出到页面上
* config					ServletConfig				Servlet的配置对象
* exception					Throwable					异常对象
```

## EL 表达式
Expression Language ：表达式语言，用于替换和简化 JSP 页面中 java 代码的编写 ，书写语法：`${表达式}`

* **注意**：JSP 默认支持 EL 表达式，如果要忽略 EL 表达式可以进行以下设置
    * 设置JSP中page指令中：isELIgnored="true" 忽略当前  JSP  页面中所有的 EL 表达式
    * \${表达式} ：忽略当前这个el表达式

### EL 的使用

#### 运算

EL 相关运算符：
1. 算数运算符： `+` `-` `*` `/`(div) `%`(mod)
2. 比较运算符： `>` `<` `>=` `<=` `==` `!=`
3. 逻辑运算符： `&&`(and) `||`(or) `!`(not)
4. **空运算符**： `empty`
    * 功能：用于判断字符串、集合、数组对象是否为**空字符串("")**、 **null** 以及**长度是否为 0**
    * ${empty list}:表示判断域对象中此集合是否为 **null** 以及**长度是否为 0**
    * ${not empty str}:表示判断域对象中此字符串是否不为**空字符串("")**、 **null** 以及**长度是否为 0**


#### 获取值
注意：EL 表达式只能从**域对象**中获取值

* 从指定域中获取指定键的值：`${域名称.键名}`

| EL 中域名称 | 对应 java域名称 |
| ---------- | -------------- |
| pageScope  | pageContext ( PageContext )|
| requestScope  | request ( HttpServletRequest ) |
| sessionScope  | session ( HttpServletResponse ) |
| applicationScope  | application ( ServletContext )|

举例：在 request 域中存储了 name = jay ----->获取：`${requestScope.name}`

* 获取对象、List 、Map 的值
    1. 对象：（本质上会去调用对象的对应属性名的 Getter 方法）
        * ${域名称.键名.属性名}
        * ${域名称.键名[索引]}

    2. List集合：${域名称.键名[索引]}

    3. Map集合：
        * ${域名称.键名.Map中的key名称}
        * ${域名称.键名[索引]}

* 直接获取某个键的值：`${键名}` ， 表示依次从最小的域中查找是否有该键对应的值，直到找到为止。
* 获取某个 cookie ：`${cookie.cookie名.value}`


### 隐式对象

* el 表达式中有11个隐式对象
* pageContext：
    * 获取JSP其他八个内置对象
        * ${pageContext.request.contextPath}：动态获取虚拟目录
					

## JSTL 标签
1. 概念：JavaServer Pages Tag Library  JSP 标准标签库

2. 作用：用于简化和替换JSP页面上的java代码		

3. 使用步骤：
* 导入 jstl 相关 jar 包
* 引入 core 标签库 `<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>`
* 使用标签

4. 常用的 JSTL 标签
	* if :相当于 java 代码的 if 语句
		1. 属性：
			* test 必须指定的属性，接受boolean表达式
				* 如果表达式为true，则显示if标签体内容，如果为false，则不显示标签体内容
				* 一般情况下，test属性值会结合el表达式一起使用
			* var 判断结果存储进域对象的键名，默认存到 page 域
			* scope 指定判断结果要存放的域：page、application、request、session
		2. 注意：
			* c:if 标签没有 else 情况，想要 else 情况，则可以后面再定义一个 c:if 标签
	* choose:相当于 java 代码的 switch 语句
		1. 使用 choose 标签声明         		        相当于 switch 声明
		2. 使用 EL 配合 when 标签做判断         		 相当于 case
		3. 使用 EL 配合 otherwise 标签做其他情况的声明    相当于 default

	* foreach :相当于 java 代码的 for 语句
		1. begin 指定遍历开始下标，默认为 0
		2. end 指定遍历结束下标，默认为 0
		3. step 指定遍历步长，默认为 1
		4. items 指定遍历目标
		5. var 指定遍历每个元素的键名，此键只能在循环里面使用
		6. varStatus 指定遍历每个元素状态的键名
			* index
			* count
			* current
			* first
			* last

## MVC：开发模式	
1. JSP演变历史
1. 早期只有servlet，只能使用response输出标签数据，非常麻烦
2. 后来又JSP，简化了Servlet的开发，如果过度使用JSP，在JSP中即写大量的java代码，有写html表，造成难于维护，难于分工协作
3. 再后来，java的web开发，借鉴mvc开发模式，使得程序的设计更加合理性

2. MVC：
1. M：Model，模型。JavaBean
	* 完成具体的业务操作，如：查询数据库，封装对象
2. V：View，视图。JSP
	* 展示数据
3. C：Controller，控制器。Servlet
	* 获取用户的输入
	* 调用模型
	* 将数据交给视图进行展示


* 优缺点：
	1. 优点：
		1. 耦合性低，方便维护，可以利于分工协作
		2. 重用性高

	2. 缺点：
		1. 使得项目架构变得复杂，对开发人员要求高

## 三层架构：软件设计架构
1. 界面层(表示层)：用户看的得界面。用户可以通过界面上的组件和服务器进行交互
2. 业务逻辑层：处理业务逻辑的。
3. 数据访问层：操作数据存储文件。

## 案例：用户信息列表展示
1. 需求：用户信息的增删改查操作
2. 设计：
	1. 技术选型：Servlet+ JSP +MySQL+JDBCTempleat+Duird+BeanUtilS+tomcat
	2. 数据库设计：
```sql
	create database db1; -- 创建数据库
	use db1; 			   -- 使用数据库
	create table user(   -- 创建表
		id int primary key auto_increment,
		name varchar(20) not null,
		gender varchar(5),
		age int,
		address varchar(32),
		qq	varchar(20),
		email varchar(50)
	);
```		


# 路径问题
相对路径：一般写法以 .或.. 开头
	
绝对路径：一般写法以 / 开头
* 一般用于服务器内部请求转发
完整路径：一般用于客服端请求，只有请求转发不能使用